// Copyright - The University of Edinburgh 2015
/*******************************************************************************
 * Copyright (c) - The Univeristy of Edinburgh 2010
 *******************************************************************************/
package uk.ac.ed.epcc.safe.accounting.parsers;

import java.util.ArrayList;
import java.util.Collection;

import org.junit.Before;

import uk.ac.ed.epcc.safe.accounting.update.AccountingParseException;
import uk.ac.ed.epcc.safe.accounting.update.SkipRecord;

public class EuforiaPBSREcordTest  extends AbstractRecordTestCase{

	private static final Collection<RecordText> goodRecords = new ArrayList<RecordText>();
	private static final Collection<BadRecordText> badTexts = new ArrayList<BadRecordText>();

	public EuforiaPBSREcordTest() {
		super("PBSMachine", "PBSRecord");
	}
	@Before
	public void loadData() throws Exception{
		load("EuforiaPBSREcordTest.xml");
	}
	/**
	 * Tests are not going to be altered at runtime so we declare them all in a
	 * static block and add them to either the good records or bad records
	 * collection
	 */
	static {
		String validRecords[] = new String[] {
				"06/10/2009 00:00:53;E;709813.iwrcgpbs0.fzk.de;user=dgmd0010 group=medigrid jobname=STDIN queue=dgiseq ctime=1244584802 qtime=1244584802 etime=1244584802 start=1244584853 exec_host=iwrcgop092/0 Resource_List.ncpus=1 Resource_List.neednodes=nodes=1:ppn=1 Resource_List.nodect=1 Resource_List.nodes=nodes=1:ppn=1 Resource_List.walltime=12:00:00 session=3323 end=1244584853 Exit_status=0 resources_used.cput=00:00:00 resources_used.mem=0kb resources_used.vmem=0kb resources_used.walltime=00:00:01",
				"06/10/2009 00:23:20;E;709814.iwrcgpbs0.fzk.de;user=dteam009 group=dteam jobname=STDIN queue=dgiseq ctime=1244586166 qtime=1244586166 etime=1244586166 start=1244586198 exec_host=iwrcgop092/0 Resource_List.ncpus=1 Resource_List.neednodes=1 Resource_List.nodect=1 Resource_List.nodes=1 Resource_List.walltime=12:00:00 session=4901 end=1244586200 Exit_status=0 resources_used.cput=00:00:00 resources_used.mem=10872kb resources_used.vmem=289296kb resources_used.walltime=00:00:02",
				"06/10/2009 01:00:55;E;709815.iwrcgpbs0.fzk.de;user=dgmd0010 group=medigrid jobname=STDIN queue=dgiseq ctime=1244588401 qtime=1244588401 etime=1244588401 start=1244588455 exec_host=iwrcgop092/0 Resource_List.ncpus=1 Resource_List.neednodes=nodes=1:ppn=1 Resource_List.nodect=1 Resource_List.nodes=nodes=1:ppn=1 Resource_List.walltime=12:00:00 session=6579 end=1244588455 Exit_status=0 resources_used.cput=00:00:00 resources_used.mem=0kb resources_used.vmem=0kb resources_used.walltime=00:00:00",
				"06/10/2009 02:01:55;E;709816.iwrcgpbs0.fzk.de;user=dgmd0010 group=medigrid jobname=STDIN queue=dgiseq ctime=1244592066 qtime=1244592066 etime=1244592066 start=1244592115 exec_host=iwrcgop092/0 Resource_List.ncpus=1 Resource_List.neednodes=nodes=1:ppn=1 Resource_List.nodect=1 Resource_List.nodes=nodes=1:ppn=1 Resource_List.walltime=12:00:00 session=9354 end=1244592115 Exit_status=0 resources_used.cput=00:00:00 resources_used.mem=0kb resources_used.vmem=0kb resources_used.walltime=00:00:01",
				"06/10/2009 02:37:31;E;709817.iwrcgpbs0.fzk.de;user=dgmd0007 group=medigrid jobname=STDIN queue=dgiexp ctime=1244594217 qtime=1244594217 etime=1244594217 start=1244594251 exec_host=iwrcgop092/0 Resource_List.ncpus=1 Resource_List.neednodes=1 Resource_List.nodect=1 Resource_List.nodes=1 Resource_List.walltime=00:04:00 session=11044 end=1244594251 Exit_status=0 resources_used.cput=00:00:00 resources_used.mem=0kb resources_used.vmem=0kb resources_used.walltime=00:00:00",
				"06/10/2009 03:01:55;E;709818.iwrcgpbs0.fzk.de;user=dgmd0010 group=medigrid jobname=STDIN queue=dgiseq ctime=1244595668 qtime=1244595668 etime=1244595668 start=1244595715 exec_host=iwrcgop092/0 Resource_List.ncpus=1 Resource_List.neednodes=nodes=1:ppn=1 Resource_List.nodect=1 Resource_List.nodes=nodes=1:ppn=1 Resource_List.walltime=12:00:00 session=12417 end=1244595715 Exit_status=0 resources_used.cput=00:00:00 resources_used.mem=0kb resources_used.vmem=0kb resources_used.walltime=00:00:01",
				"06/10/2009 03:17:58;E;709313.iwrcgpbs0.fzk.de;user=dgad0004 group=astrogrid jobname=STDIN queue=dgiseq ctime=1244513828 qtime=1244513828 etime=1244513828 start=1244513831 exec_host=iwrcgop130/6 Resource_List.ncpus=1 Resource_List.neednodes=1 Resource_List.nodect=1 Resource_List.nodes=1 Resource_List.walltime=23:30:00 session=8832 end=1244596678 Exit_status=0 resources_used.cput=22:59:29 resources_used.mem=158196kb resources_used.vmem=407496kb resources_used.walltime=23:00:45",
				"06/10/2009 03:17:58;E;709314.iwrcgpbs0.fzk.de;user=dgad0004 group=astrogrid jobname=STDIN queue=dgiseq ctime=1244513830 qtime=1244513830 etime=1244513830 start=1244513831 exec_host=iwrcgop130/7 Resource_List.ncpus=1 Resource_List.neednodes=1 Resource_List.nodect=1 Resource_List.nodes=1 Resource_List.walltime=23:30:00 session=8941 end=1244596678 Exit_status=0 resources_used.cput=22:59:21 resources_used.mem=118740kb resources_used.vmem=367056kb resources_used.walltime=23:00:45",
				"06/10/2009 03:19:01;E;709317.iwrcgpbs0.fzk.de;user=dgad0004 group=astrogrid jobname=STDIN queue=dgiseq ctime=1244513835 qtime=1244513835 etime=1244513835 start=1244513892 exec_host=iwrcgop128/6 Resource_List.ncpus=1 Resource_List.neednodes=1 Resource_List.nodect=1 Resource_List.nodes=1 Resource_List.walltime=23:30:00 session=15250 end=1244596741 Exit_status=0 resources_used.cput=22:58:29 resources_used.mem=157992kb resources_used.vmem=407444kb resources_used.walltime=23:00:46",
				"06/10/2009 03:19:02;E;709315.iwrcgpbs0.fzk.de;user=dgad0004 group=astrogrid jobname=STDIN queue=dgiseq ctime=1244513832 qtime=1244513832 etime=1244513832 start=1244513892 exec_host=iwrcgop128/0 Resource_List.ncpus=1 Resource_List.neednodes=1 Resource_List.nodect=1 Resource_List.nodes=1 Resource_List.walltime=23:30:00 session=15099 end=1244596742 Exit_status=0 resources_used.cput=22:59:14 resources_used.mem=158160kb resources_used.vmem=407560kb resources_used.walltime=23:00:47",
				"06/12/2009 18:01:54;E;710126.iwrcgpbs0.fzk.de;user=dgmd0010 group=medigrid jobname=STDIN queue=dgiseq ctime=1244822469 qtime=1244822469 etime=1244822469 start=1244822514 exec_host=iwrcgop067/0 Resource_List.ncpus=1 Resource_List.neednodes=nodes=1:ppn=1 Resource_List.nodect=1 Resource_List.nodes=nodes=1:ppn=1 Resource_List.walltime=12:00:00 session=20234 end=1244822514 Exit_status=0 resources_used.cput=00:00:00 resources_used.mem=0kb resources_used.vmem=0kb resources_used.walltime=00:00:00",
				"06/12/2009 19:01:55;E;710127.iwrcgpbs0.fzk.de;user=dgmd0010 group=medigrid jobname=STDIN queue=dgiseq ctime=1244826068 qtime=1244826068 etime=1244826068 start=1244826115 exec_host=iwrcgop067/0 Resource_List.ncpus=1 Resource_List.neednodes=nodes=1:ppn=1 Resource_List.nodect=1 Resource_List.nodes=nodes=1:ppn=1 Resource_List.walltime=12:00:00 session=23144 end=1244826115 Exit_status=0 resources_used.cput=00:00:00 resources_used.mem=0kb resources_used.vmem=0kb resources_used.walltime=00:00:01",
				"06/12/2009 20:00:53;E;710128.iwrcgpbs0.fzk.de;user=dgmd0010 group=medigrid jobname=STDIN queue=dgiseq ctime=1244829651 qtime=1244829651 etime=1244829651 start=1244829653 exec_host=iwrcgop067/0 Resource_List.ncpus=1 Resource_List.neednodes=nodes=1:ppn=1 Resource_List.nodect=1 Resource_List.nodes=nodes=1:ppn=1 Resource_List.walltime=12:00:00 session=26058 end=1244829653 Exit_status=0 resources_used.cput=00:00:00 resources_used.mem=0kb resources_used.vmem=0kb resources_used.walltime=00:00:00",
				"06/12/2009 21:00:46;E;710129.iwrcgpbs0.fzk.de;user=dgmd0010 group=medigrid jobname=STDIN queue=dgiseq ctime=1244833214 qtime=1244833214 etime=1244833214 start=1244833246 exec_host=iwrcgop067/0 Resource_List.ncpus=1 Resource_List.neednodes=nodes=1:ppn=1 Resource_List.nodect=1 Resource_List.nodes=nodes=1:ppn=1 Resource_List.walltime=12:00:00 session=28968 end=1244833246 Exit_status=0 resources_used.cput=00:00:00 resources_used.mem=0kb resources_used.vmem=0kb resources_used.walltime=00:00:01",
				"06/12/2009 22:00:45;E;710130.iwrcgpbs0.fzk.de;user=dgmd0010 group=medigrid jobname=STDIN queue=dgiseq ctime=1244836803 qtime=1244836803 etime=1244836803 start=1244836845 exec_host=iwrcgop067/0 Resource_List.ncpus=1 Resource_List.neednodes=nodes=1:ppn=1 Resource_List.nodect=1 Resource_List.nodes=nodes=1:ppn=1 Resource_List.walltime=12:00:00 session=31887 end=1244836845 Exit_status=0 resources_used.cput=00:00:00 resources_used.mem=0kb resources_used.vmem=0kb resources_used.walltime=00:00:00",
				"06/12/2009 22:14:11;E;710131.iwrcgpbs0.fzk.de;user=dgmd0049 group=medigrid jobname=GenDataFileExec queue=dgiseq ctime=1244837634 qtime=1244837634 etime=1244837634 start=1244837648 exec_host=iwrcgop067/0 Resource_List.cput=00:10:00 Resource_List.mem=1000mb Resource_List.ncpus=1 Resource_List.neednodes=1:ppn=1 Resource_List.nodect=1 Resource_List.nodes=1:ppn=1 Resource_List.walltime=12:00:00 session=32715 end=1244837651 Exit_status=0 resources_used.cput=00:00:02 resources_used.mem=0kb resources_used.vmem=0kb resources_used.walltime=00:00:04",
				"06/12/2009 22:45:45;E;710138.iwrcgpbs0.fzk.de;user=dgdtsgm group=dgtest jobname=STDIN queue=dgiexp ctime=1244839524 qtime=1244839524 etime=1244839524 start=1244839539 exec_host=iwrcgop067/0 Resource_List.ncpus=1 Resource_List.neednodes=1 Resource_List.nodect=1 Resource_List.nodes=1 Resource_List.walltime=00:05:00 session=3096 end=1244839545 Exit_status=0 resources_used.cput=00:00:02 resources_used.mem=0kb resources_used.vmem=0kb resources_used.walltime=00:00:07",
				"06/12/2009 23:00:54;E;710139.iwrcgpbs0.fzk.de;user=dgmd0010 group=medigrid jobname=STDIN queue=dgiseq ctime=1244840402 qtime=1244840402 etime=1244840402 start=1244840454 exec_host=iwrcgop067/0 Resource_List.ncpus=1 Resource_List.neednodes=nodes=1:ppn=1 Resource_List.nodect=1 Resource_List.nodes=nodes=1:ppn=1 Resource_List.walltime=12:00:00 session=5115 end=1244840454 Exit_status=0 resources_used.cput=00:00:00 resources_used.mem=0kb resources_used.vmem=0kb resources_used.walltime=00:00:00",
				"06/12/2009 23:45:54;E;710140.iwrcgpbs0.fzk.de;user=dgdt0054 group=dgtest jobname=STDIN queue=dgipar ctime=1244843109 qtime=1244843109 etime=1244843109 start=1244843138 exec_host=iwrcgop067/0 Resource_List.ncpus=1 Resource_List.neednodes=1 Resource_List.nodect=1 Resource_List.nodes=1 Resource_List.walltime=12:00:00 session=6840 end=1244843154 Exit_status=0 resources_used.cput=00:00:04 resources_used.mem=0kb resources_used.vmem=0kb resources_used.walltime=00:00:15",
				"06/10/2009 08:53:39;E;710078.iwrcgpbs0.fzk.de;user=eufo015 group=euforia jobname=STDIN queue=i2gpar ctime=1244616299 qtime=1244616299 etime=1244616299 start=1244616339 exec_host=iwrcgop135/7+iwrcgop135/6+iwrcgop135/5+iwrcgop135/4+iwrcgop135/3+iwrcgop135/2+iwrcgop135/1+iwrcgop135/0+iwrcgop133/7+iwrcgop133/6+iwrcgop133/5+iwrcgop133/4+iwrcgop133/3+iwrcgop133/2+iwrcgop133/1+iwrcgop133/0+iwrcgop131/7+iwrcgop131/6+iwrcgop131/5+iwrcgop131/4+iwrcgop131/3+iwrcgop131/2+iwrcgop131/1+iwrcgop131/0+iwrcgop129/7+iwrcgop129/6+iwrcgop129/5+iwrcgop129/4+iwrcgop129/3+iwrcgop129/2+iwrcgop129/1+iwrcgop129/0+iwrcgop127/7+iwrcgop127/6+iwrcgop127/5+iwrcgop127/4+iwrcgop127/3+iwrcgop127/2+iwrcgop127/1+iwrcgop127/0+iwrcgop125/7+iwrcgop125/6+iwrcgop125/5+iwrcgop125/4+iwrcgop125/3+iwrcgop125/2+iwrcgop125/1+iwrcgop125/0+iwrcgop123/7+iwrcgop123/6+iwrcgop123/5+iwrcgop123/4+iwrcgop123/3+iwrcgop123/2+iwrcgop123/1+iwrcgop123/0+iwrcgop121/7+iwrcgop121/6+iwrcgop121/5+iwrcgop121/4+iwrcgop121/3+iwrcgop121/2+iwrcgop121/1+iwrcgop121/0+iwrcgop120/7+iwrcgop120/6+iwrcgop120/5+iwrcgop120/4+iwrcgop120/3+iwrcgop120/2+iwrcgop120/1+iwrcgop120/0+iwrcgop119/7+iwrcgop119/6+iwrcgop119/5+iwrcgop119/4+iwrcgop119/3+iwrcgop119/2+iwrcgop119/1+iwrcgop119/0+iwrcgop118/7+iwrcgop118/6+iwrcgop118/5+iwrcgop118/4+iwrcgop118/3+iwrcgop118/2+iwrcgop118/1+iwrcgop118/0+iwrcgop117/7+iwrcgop117/6+iwrcgop117/5+iwrcgop117/4+iwrcgop117/3+iwrcgop117/2+iwrcgop117/1+iwrcgop117/0+iwrcgop116/7+iwrcgop116/6+iwrcgop116/5+iwrcgop116/4+iwrcgop116/3+iwrcgop116/2+iwrcgop116/1+iwrcgop116/0+iwrcgop115/7+iwrcgop115/6+iwrcgop115/5+iwrcgop115/4+iwrcgop115/3+iwrcgop115/2+iwrcgop115/1+iwrcgop115/0+iwrcgop103/5+iwrcgop103/4+iwrcgop103/3+iwrcgop103/2+iwrcgop103/1+iwrcgop103/0+iwrcgop102/7+iwrcgop102/6+iwrcgop102/5+iwrcgop102/4+iwrcgop102/3+iwrcgop102/2+iwrcgop102/1+iwrcgop102/0+iwrcgop101/1+iwrcgop101/0 Resource_List.ncpus=1 Resource_List.neednodes=14:ppn=8+16:ppn=1 Resource_List.nodect=30 Resource_List.nodes=14:ppn=8+16:ppn=1 Resource_List.walltime=12:00:00 session=22227 end=1244616819 Exit_status=0 resources_used.cput=00:00:05 resources_used.mem=47464kb resources_used.vmem=577904kb resources_used.walltime=00:07:13",
				"06/10/2009 09:05:52;E;710079.iwrcgpbs0.fzk.de;user=eufo015 group=euforia jobname=STDIN queue=i2gpar ctime=1244616336 qtime=1244616336 etime=1244616336 start=1244616339 exec_host=iwrcgop134/7+iwrcgop134/6+iwrcgop134/5+iwrcgop134/4+iwrcgop134/3+iwrcgop134/2+iwrcgop134/1+iwrcgop134/0+iwrcgop130/7+iwrcgop130/6+iwrcgop130/5+iwrcgop130/4+iwrcgop130/3+iwrcgop130/2+iwrcgop130/1+iwrcgop130/0+iwrcgop126/7+iwrcgop126/6+iwrcgop126/5+iwrcgop126/4+iwrcgop126/3+iwrcgop126/2+iwrcgop126/1+iwrcgop126/0+iwrcgop122/7+iwrcgop122/6+iwrcgop122/5+iwrcgop122/4+iwrcgop122/3+iwrcgop122/2+iwrcgop122/1+iwrcgop122/0+iwrcgop113/7+iwrcgop113/6+iwrcgop113/5+iwrcgop113/4+iwrcgop113/3+iwrcgop113/2+iwrcgop113/1+iwrcgop113/0+iwrcgop111/7+iwrcgop111/6+iwrcgop111/5+iwrcgop111/4+iwrcgop111/3+iwrcgop111/2+iwrcgop111/1+iwrcgop111/0+iwrcgop109/7+iwrcgop109/6+iwrcgop109/5+iwrcgop109/4+iwrcgop109/3+iwrcgop109/2+iwrcgop109/1+iwrcgop109/0+iwrcgop107/7+iwrcgop107/6+iwrcgop107/5+iwrcgop107/4+iwrcgop107/3+iwrcgop107/2+iwrcgop107/1+iwrcgop107/0+iwrcgop106/7+iwrcgop106/6+iwrcgop106/5+iwrcgop106/4+iwrcgop106/3+iwrcgop106/2+iwrcgop106/1+iwrcgop106/0+iwrcgop105/7+iwrcgop105/6+iwrcgop105/5+iwrcgop105/4+iwrcgop105/3+iwrcgop105/2+iwrcgop105/1+iwrcgop105/0+iwrcgop104/7+iwrcgop104/6+iwrcgop104/5+iwrcgop104/4+iwrcgop104/3+iwrcgop104/2+iwrcgop104/1+iwrcgop104/0+iwrcgop099/7+iwrcgop099/6+iwrcgop099/5+iwrcgop099/4+iwrcgop099/3+iwrcgop099/2+iwrcgop099/1+iwrcgop099/0+iwrcgop098/7+iwrcgop098/6+iwrcgop098/5+iwrcgop098/4+iwrcgop098/3+iwrcgop098/2+iwrcgop098/1+iwrcgop098/0+iwrcgop097/7+iwrcgop097/6+iwrcgop097/5+iwrcgop097/4+iwrcgop097/3+iwrcgop097/2+iwrcgop097/1+iwrcgop097/0+iwrcgop146/7+iwrcgop146/6+iwrcgop136/7+iwrcgop136/6+iwrcgop132/7+iwrcgop132/6+iwrcgop132/5+iwrcgop132/4+iwrcgop132/3+iwrcgop132/2+iwrcgop132/1+iwrcgop132/0+iwrcgop128/3+iwrcgop128/2+iwrcgop128/1+iwrcgop128/0 Resource_List.ncpus=1 Resource_List.neednodes=14:ppn=8+16:ppn=1 Resource_List.nodect=30 Resource_List.nodes=14:ppn=8+16:ppn=1 Resource_List.walltime=12:00:00 session=18268 end=1244617552 Exit_status=0 resources_used.cput=40:22:47 resources_used.mem=71091512kb resources_used.vmem=137550700kb resources_used.walltime=00:20:51",
				"06/10/2009 11:24:42;E;710090.iwrcgpbs0.fzk.de;user=eufo015 group=euforia jobname=STDIN queue=i2gpar ctime=1244624633 qtime=1244624633 etime=1244624633 start=1244624638 exec_host=iwrcgop133/7+iwrcgop133/6+iwrcgop133/5+iwrcgop133/4+iwrcgop133/3+iwrcgop133/2+iwrcgop133/1+iwrcgop133/0+iwrcgop129/7+iwrcgop129/6+iwrcgop129/5+iwrcgop129/4+iwrcgop129/3+iwrcgop129/2+iwrcgop129/1+iwrcgop129/0+iwrcgop127/7+iwrcgop127/6+iwrcgop127/5+iwrcgop127/4+iwrcgop127/3+iwrcgop127/2+iwrcgop127/1+iwrcgop127/0+iwrcgop124/7+iwrcgop124/6+iwrcgop124/5+iwrcgop124/4+iwrcgop124/3+iwrcgop124/2+iwrcgop124/1+iwrcgop124/0+iwrcgop121/7+iwrcgop121/6+iwrcgop121/5+iwrcgop121/4+iwrcgop121/3+iwrcgop121/2+iwrcgop121/1+iwrcgop121/0+iwrcgop119/7+iwrcgop119/6+iwrcgop119/5+iwrcgop119/4+iwrcgop119/3+iwrcgop119/2+iwrcgop119/1+iwrcgop119/0+iwrcgop117/7+iwrcgop117/6+iwrcgop117/5+iwrcgop117/4+iwrcgop117/3+iwrcgop117/2+iwrcgop117/1+iwrcgop117/0+iwrcgop116/7+iwrcgop116/6+iwrcgop116/5+iwrcgop116/4+iwrcgop116/3+iwrcgop116/2+iwrcgop116/1+iwrcgop116/0+iwrcgop115/7+iwrcgop115/6+iwrcgop115/5+iwrcgop115/4+iwrcgop115/3+iwrcgop115/2+iwrcgop115/1+iwrcgop115/0+iwrcgop114/7+iwrcgop114/6+iwrcgop114/5+iwrcgop114/4+iwrcgop114/3+iwrcgop114/2+iwrcgop114/1+iwrcgop114/0+iwrcgop113/7+iwrcgop113/6+iwrcgop113/5+iwrcgop113/4+iwrcgop113/3+iwrcgop113/2+iwrcgop113/1+iwrcgop113/0+iwrcgop112/7+iwrcgop112/6+iwrcgop112/5+iwrcgop112/4+iwrcgop112/3+iwrcgop112/2+iwrcgop112/1+iwrcgop112/0+iwrcgop110/7+iwrcgop110/6+iwrcgop110/5+iwrcgop110/4+iwrcgop110/3+iwrcgop110/2+iwrcgop110/1+iwrcgop110/0+iwrcgop109/7+iwrcgop109/6+iwrcgop109/5+iwrcgop109/4+iwrcgop109/3+iwrcgop109/2+iwrcgop109/1+iwrcgop109/0+iwrcgop102/5+iwrcgop102/4+iwrcgop102/3+iwrcgop102/2+iwrcgop102/1+iwrcgop102/0+iwrcgop101/7+iwrcgop101/6+iwrcgop101/5+iwrcgop101/4+iwrcgop101/3+iwrcgop101/2+iwrcgop101/1+iwrcgop101/0+iwrcgop100/1+iwrcgop100/0 Resource_List.ncpus=1 Resource_List.neednodes=14:ppn=8+16:ppn=1 Resource_List.nodect=30 Resource_List.nodes=14:ppn=8+16:ppn=1 Resource_List.walltime=12:00:00 session=13173 end=1244625882 Exit_status=0 resources_used.cput=41:21:51 resources_used.mem=70295052kb resources_used.vmem=128014220kb resources_used.walltime=00:21:09",
				"06/10/2009 11:45:05;E;710091.iwrcgpbs0.fzk.de;user=eufo015 group=euforia jobname=STDIN queue=i2gpar ctime=1244624639 qtime=1244624639 etime=1244624639 start=1244625919 exec_host=iwrcgop133/7+iwrcgop133/6+iwrcgop133/5+iwrcgop133/4+iwrcgop133/3+iwrcgop133/2+iwrcgop133/1+iwrcgop133/0+iwrcgop129/7+iwrcgop129/6+iwrcgop129/5+iwrcgop129/4+iwrcgop129/3+iwrcgop129/2+iwrcgop129/1+iwrcgop129/0+iwrcgop127/7+iwrcgop127/6+iwrcgop127/5+iwrcgop127/4+iwrcgop127/3+iwrcgop127/2+iwrcgop127/1+iwrcgop127/0+iwrcgop124/7+iwrcgop124/6+iwrcgop124/5+iwrcgop124/4+iwrcgop124/3+iwrcgop124/2+iwrcgop124/1+iwrcgop124/0+iwrcgop121/7+iwrcgop121/6+iwrcgop121/5+iwrcgop121/4+iwrcgop121/3+iwrcgop121/2+iwrcgop121/1+iwrcgop121/0+iwrcgop119/7+iwrcgop119/6+iwrcgop119/5+iwrcgop119/4+iwrcgop119/3+iwrcgop119/2+iwrcgop119/1+iwrcgop119/0+iwrcgop117/7+iwrcgop117/6+iwrcgop117/5+iwrcgop117/4+iwrcgop117/3+iwrcgop117/2+iwrcgop117/1+iwrcgop117/0+iwrcgop116/7+iwrcgop116/6+iwrcgop116/5+iwrcgop116/4+iwrcgop116/3+iwrcgop116/2+iwrcgop116/1+iwrcgop116/0+iwrcgop115/7+iwrcgop115/6+iwrcgop115/5+iwrcgop115/4+iwrcgop115/3+iwrcgop115/2+iwrcgop115/1+iwrcgop115/0+iwrcgop114/7+iwrcgop114/6+iwrcgop114/5+iwrcgop114/4+iwrcgop114/3+iwrcgop114/2+iwrcgop114/1+iwrcgop114/0+iwrcgop113/7+iwrcgop113/6+iwrcgop113/5+iwrcgop113/4+iwrcgop113/3+iwrcgop113/2+iwrcgop113/1+iwrcgop113/0+iwrcgop112/7+iwrcgop112/6+iwrcgop112/5+iwrcgop112/4+iwrcgop112/3+iwrcgop112/2+iwrcgop112/1+iwrcgop112/0+iwrcgop110/7+iwrcgop110/6+iwrcgop110/5+iwrcgop110/4+iwrcgop110/3+iwrcgop110/2+iwrcgop110/1+iwrcgop110/0+iwrcgop109/7+iwrcgop109/6+iwrcgop109/5+iwrcgop109/4+iwrcgop109/3+iwrcgop109/2+iwrcgop109/1+iwrcgop109/0+iwrcgop102/5+iwrcgop102/4+iwrcgop102/3+iwrcgop102/2+iwrcgop102/1+iwrcgop102/0+iwrcgop101/7+iwrcgop101/6+iwrcgop101/5+iwrcgop101/4+iwrcgop101/3+iwrcgop101/2+iwrcgop101/1+iwrcgop101/0+iwrcgop100/1+iwrcgop100/0 Resource_List.ncpus=1 Resource_List.neednodes=14:ppn=8+16:ppn=1 Resource_List.nodect=30 Resource_List.nodes=14:ppn=8+16:ppn=1 Resource_List.walltime=12:00:00 session=15351 end=1244627105 Exit_status=0 resources_used.cput=39:56:42 resources_used.mem=69812304kb resources_used.vmem=128718200kb resources_used.walltime=00:20:25",
				"06/10/2009 23:46:13;E;710092.iwrcgpbs0.fzk.de;user=eufo015 group=euforia jobname=STDIN queue=i2gpar ctime=1244624639 qtime=1244624639 etime=1244624639 start=1244627139 exec_host=iwrcgop133/7+iwrcgop133/6+iwrcgop133/5+iwrcgop133/4+iwrcgop133/3+iwrcgop133/2+iwrcgop133/1+iwrcgop133/0+iwrcgop129/7+iwrcgop129/6+iwrcgop129/5+iwrcgop129/4+iwrcgop129/3+iwrcgop129/2+iwrcgop129/1+iwrcgop129/0+iwrcgop127/7+iwrcgop127/6+iwrcgop127/5+iwrcgop127/4+iwrcgop127/3+iwrcgop127/2+iwrcgop127/1+iwrcgop127/0+iwrcgop124/7+iwrcgop124/6+iwrcgop124/5+iwrcgop124/4+iwrcgop124/3+iwrcgop124/2+iwrcgop124/1+iwrcgop124/0+iwrcgop121/7+iwrcgop121/6+iwrcgop121/5+iwrcgop121/4+iwrcgop121/3+iwrcgop121/2+iwrcgop121/1+iwrcgop121/0+iwrcgop119/7+iwrcgop119/6+iwrcgop119/5+iwrcgop119/4+iwrcgop119/3+iwrcgop119/2+iwrcgop119/1+iwrcgop119/0+iwrcgop117/7+iwrcgop117/6+iwrcgop117/5+iwrcgop117/4+iwrcgop117/3+iwrcgop117/2+iwrcgop117/1+iwrcgop117/0+iwrcgop116/7+iwrcgop116/6+iwrcgop116/5+iwrcgop116/4+iwrcgop116/3+iwrcgop116/2+iwrcgop116/1+iwrcgop116/0+iwrcgop115/7+iwrcgop115/6+iwrcgop115/5+iwrcgop115/4+iwrcgop115/3+iwrcgop115/2+iwrcgop115/1+iwrcgop115/0+iwrcgop114/7+iwrcgop114/6+iwrcgop114/5+iwrcgop114/4+iwrcgop114/3+iwrcgop114/2+iwrcgop114/1+iwrcgop114/0+iwrcgop113/7+iwrcgop113/6+iwrcgop113/5+iwrcgop113/4+iwrcgop113/3+iwrcgop113/2+iwrcgop113/1+iwrcgop113/0+iwrcgop112/7+iwrcgop112/6+iwrcgop112/5+iwrcgop112/4+iwrcgop112/3+iwrcgop112/2+iwrcgop112/1+iwrcgop112/0+iwrcgop110/7+iwrcgop110/6+iwrcgop110/5+iwrcgop110/4+iwrcgop110/3+iwrcgop110/2+iwrcgop110/1+iwrcgop110/0+iwrcgop109/7+iwrcgop109/6+iwrcgop109/5+iwrcgop109/4+iwrcgop109/3+iwrcgop109/2+iwrcgop109/1+iwrcgop109/0+iwrcgop102/5+iwrcgop102/4+iwrcgop102/3+iwrcgop102/2+iwrcgop102/1+iwrcgop102/0+iwrcgop101/7+iwrcgop101/6+iwrcgop101/5+iwrcgop101/4+iwrcgop101/3+iwrcgop101/2+iwrcgop101/1+iwrcgop101/0+iwrcgop100/1+iwrcgop100/0 Resource_List.ncpus=1 Resource_List.neednodes=14:ppn=8+16:ppn=1 Resource_List.nodect=30 Resource_List.nodes=14:ppn=8+16:ppn=1 Resource_List.walltime=12:00:00 session=17893 end=1244670373 Exit_status=271 resources_used.cput=1526:32:52 resources_used.mem=70275172kb resources_used.vmem=133083884kb resources_used.walltime=12:00:29",
				"06/11/2009 05:02:47;E;710093.iwrcgpbs0.fzk.de;user=eufo015 group=euforia jobname=STDIN queue=i2gpar ctime=1244624644 qtime=1244624644 etime=1244624644 start=1244646149 exec_host=iwrcgop135/7+iwrcgop135/6+iwrcgop135/5+iwrcgop135/4+iwrcgop135/3+iwrcgop135/2+iwrcgop135/1+iwrcgop135/0+iwrcgop132/7+iwrcgop132/6+iwrcgop132/5+iwrcgop132/4+iwrcgop132/3+iwrcgop132/2+iwrcgop132/1+iwrcgop132/0+iwrcgop130/7+iwrcgop130/6+iwrcgop130/5+iwrcgop130/4+iwrcgop130/3+iwrcgop130/2+iwrcgop130/1+iwrcgop130/0+iwrcgop126/7+iwrcgop126/6+iwrcgop126/5+iwrcgop126/4+iwrcgop126/3+iwrcgop126/2+iwrcgop126/1+iwrcgop126/0+iwrcgop123/7+iwrcgop123/6+iwrcgop123/5+iwrcgop123/4+iwrcgop123/3+iwrcgop123/2+iwrcgop123/1+iwrcgop123/0+iwrcgop120/7+iwrcgop120/6+iwrcgop120/5+iwrcgop120/4+iwrcgop120/3+iwrcgop120/2+iwrcgop120/1+iwrcgop120/0+iwrcgop111/7+iwrcgop111/6+iwrcgop111/5+iwrcgop111/4+iwrcgop111/3+iwrcgop111/2+iwrcgop111/1+iwrcgop111/0+iwrcgop107/7+iwrcgop107/6+iwrcgop107/5+iwrcgop107/4+iwrcgop107/3+iwrcgop107/2+iwrcgop107/1+iwrcgop107/0+iwrcgop105/7+iwrcgop105/6+iwrcgop105/5+iwrcgop105/4+iwrcgop105/3+iwrcgop105/2+iwrcgop105/1+iwrcgop105/0+iwrcgop104/7+iwrcgop104/6+iwrcgop104/5+iwrcgop104/4+iwrcgop104/3+iwrcgop104/2+iwrcgop104/1+iwrcgop104/0+iwrcgop099/7+iwrcgop099/6+iwrcgop099/5+iwrcgop099/4+iwrcgop099/3+iwrcgop099/2+iwrcgop099/1+iwrcgop099/0+iwrcgop098/7+iwrcgop098/6+iwrcgop098/5+iwrcgop098/4+iwrcgop098/3+iwrcgop098/2+iwrcgop098/1+iwrcgop098/0+iwrcgop097/7+iwrcgop097/6+iwrcgop097/5+iwrcgop097/4+iwrcgop097/3+iwrcgop097/2+iwrcgop097/1+iwrcgop097/0+iwrcgop096/7+iwrcgop096/6+iwrcgop096/5+iwrcgop096/4+iwrcgop096/3+iwrcgop096/2+iwrcgop096/1+iwrcgop096/0+iwrcgop146/7+iwrcgop146/6+iwrcgop136/7+iwrcgop136/6+iwrcgop134/7+iwrcgop134/6+iwrcgop134/5+iwrcgop134/4+iwrcgop134/3+iwrcgop134/2+iwrcgop134/1+iwrcgop134/0+iwrcgop131/3+iwrcgop131/2+iwrcgop131/1+iwrcgop131/0 Resource_List.ncpus=1 Resource_List.neednodes=14:ppn=8+16:ppn=1 Resource_List.nodect=30 Resource_List.nodes=14:ppn=8+16:ppn=1 Resource_List.walltime=12:00:00 session=23875 end=1244689367 Exit_status=271 resources_used.cput=1531:59:19 resources_used.mem=69244512kb resources_used.vmem=133072744kb resources_used.walltime=12:00:19",
				"06/10/2009 15:26:23;E;710105.iwrcgpbs0.fzk.de;user=eufo019 group=euforia jobname=STDIN queue=i2gpar ctime=1244639967 qtime=1244639968 etime=1244639968 start=1244640013 exec_host=iwrcgop092/3+iwrcgop092/2+iwrcgop091/3+iwrcgop091/2+iwrcgop090/3+iwrcgop090/2+iwrcgop089/3+iwrcgop089/2 Resource_List.ncpus=1 Resource_List.neednodes=8:ppn=1 Resource_List.nodect=8 Resource_List.nodes=8:ppn=1 Resource_List.walltime=12:00:00 session=26388 end=1244640383 Exit_status=0 resources_used.cput=00:39:57 resources_used.mem=61532kb resources_used.vmem=1720500kb resources_used.walltime=00:06:09",
				"06/10/2009 15:56:33;E;710107.iwrcgpbs0.fzk.de;user=eufo019 group=euforia jobname=STDIN queue=i2gpar ctime=1244641687 qtime=1244641687 etime=1244641687 start=1244641721 exec_host=iwrcgop089/3+iwrcgop089/2+iwrcgop087/3+iwrcgop087/2+iwrcgop084/3+iwrcgop084/2+iwrcgop072/3+iwrcgop072/2 Resource_List.ncpus=1 Resource_List.neednodes=8:ppn=1 Resource_List.nodect=8 Resource_List.nodes=8:ppn=1 Resource_List.walltime=12:00:00 session=5675 end=1244642193 Exit_status=0 resources_used.cput=00:57:16 resources_used.mem=61540kb resources_used.vmem=1720528kb resources_used.walltime=00:09:00"
				
				};
		for (String record : validRecords)
			goodRecords.add(new RecordText(record));

		/*
		 * Records this parser shouldn't parse because they are the wrong type.
		 * Should throw SkipRecord
		 */
		String skippedRecords[] = new String[] {
				"06/12/2009 17:56:04;Q;710123.iwrcgpbs0.fzk.de;queue=routing",
				"06/12/2009 18:01:09;Q;710126.iwrcgpbs0.fzk.de;queue=dgiseq",
				"06/12/2009 18:01:54;S;710126.iwrcgpbs0.fzk.de;user=dgmd0010 group=medigrid jobname=STDIN queue=dgiseq ctime=1244822469 qtime=1244822469 etime=1244822469 start=1244822514 exec_host=iwrcgop067/0 Resource_List.ncpus=1 Resource_List.neednodes=iwrcgop067 Resource_List.nodect=1 Resource_List.nodes=nodes=1:ppn=1 Resource_List.walltime=12:00:00", 
				"06/12/2009 19:01:08;Q;710127.iwrcgpbs0.fzk.de;queue=dgiseq",
				"06/12/2009 19:01:55;S;710127.iwrcgpbs0.fzk.de;user=dgmd0010 group=medigrid jobname=STDIN queue=dgiseq ctime=1244826068 qtime=1244826068 etime=1244826068 start=1244826115 exec_host=iwrcgop067/0 Resource_List.ncpus=1 Resource_List.neednodes=iwrcgop067 Resource_List.nodect=1 Resource_List.nodes=nodes=1:ppn=1 Resource_List.walltime=12:00:00 ",
				"06/12/2009 20:00:51;Q;710128.iwrcgpbs0.fzk.de;queue=dgiseq",
				"06/12/2009 20:00:53;S;710128.iwrcgpbs0.fzk.de;user=dgmd0010 group=medigrid jobname=STDIN queue=dgiseq ctime=1244829651 qtime=1244829651 etime=1244829651 start=1244829653 exec_host=iwrcgop067/0 Resource_List.ncpus=1 Resource_List.neednodes=iwrcgop067 Resource_List.nodect=1 Resource_List.nodes=nodes=1:ppn=1 Resource_List.walltime=12:00:00", 
				"06/12/2009 21:00:14;Q;710129.iwrcgpbs0.fzk.de;queue=dgiseq",
				"06/12/2009 21:00:46;S;710129.iwrcgpbs0.fzk.de;user=dgmd0010 group=medigrid jobname=STDIN queue=dgiseq ctime=1244833214 qtime=1244833214 etime=1244833214 start=1244833246 exec_host=iwrcgop067/0 Resource_List.ncpus=1 Resource_List.neednodes=iwrcgop067 Resource_List.nodect=1 Resource_List.nodes=nodes=1:ppn=1 Resource_List.walltime=12:00:00", 
				"06/12/2009 22:00:03;Q;710130.iwrcgpbs0.fzk.de;queue=dgiseq"

				
				 };
		for (String record : skippedRecords)
			badTexts.add(new BadRecordText(record, SkipRecord.class));

		/*
		 * Make sure records with unknown types aren't parsed
		 */
		String badRecordTypeRecords[] = new String[] {
				};
		for (String record : badRecordTypeRecords)
			badTexts.add(new BadRecordText(record,
					SkipRecord.class));

		/*
		 * Make sure records without enough fields cause the parser to fail
		 * appropriately
		 */
		String tooFewFields = "01/01/2009 12:00:00;E;";
		badTexts.add(new BadRecordText(tooFewFields,
				AccountingParseException.class));
	}

	/*
	 * (non-Javadoc)
	 * 
	 * @see
	 * uk.ac.ed.epcc.safe.accounting.parsers.AbstractRecordTest#getBadRecords()
	 */
	@Override
	public Collection<BadRecordText> getBadRecords() {
		return badTexts;
	}

	/*
	 * (non-Javadoc)
	 * 
	 * @see
	 * uk.ac.ed.epcc.safe.accounting.parsers.AbstractRecordTest#getGoodRecords
	 * ()
	 */
	@Override
	public Collection<RecordText> getGoodRecords() {
		return goodRecords;
	}
}